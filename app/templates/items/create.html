{% extends "base.html" %}
{% block title %}Create Item{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-8">
    <h3>Create Item</h3>
    <form method="post">
      {{ form.hidden_tag() }}
      <div class="mb-3">
        {{ form.ssid.label(class="form-label") }}
        <div class="input-group">
          {{ form.ssid(class="form-control", id="ssidInput") }}
          <button type="button" id="genSsidBtn" class="btn btn-outline-secondary">Generate SSID</button>
        </div>
      </div>

      <div class="mb-3">
        {{ form.name.label(class="form-label") }}
        {{ form.name(class="form-control") }}
      </div>

      <div class="mb-3">
        {{ form.category.label(class="form-label") }}
        {{ form.category(class="form-control") }}
      </div>
      <!-- add other form fields as needed -->
      <button class="btn btn-primary" type="submit">Create</button>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('genSsidBtn').addEventListener('click', async () => {
    const btn = document.getElementById('genSsidBtn');
    btn.disabled = true;
    btn.textContent = 'Generating...';
    try {
        const resp = await fetch('{{ url_for("items.generate_ssid") }}', { method: 'GET', headers: { 'Accept': 'application/json' } });
        const data = await resp.json();
        if (resp.ok && data.ssid) {
            document.getElementById('ssidInput').value = data.ssid;
        } else {
            alert(data.error || 'Could not generate SSID');
        }
    } catch (err) {
        console.error(err);
        alert('Network error generating SSID');
    } finally {
        btn.disabled = false;
        btn.textContent = 'Generate SSID';
    }
});
</script>
{% endblock %}